---
dependency:
  name: galaxy

driver:
  name: ec2

platforms:
  - name: database
    image: ${MOLECULE_IT_IMAGE_ID}
    instance_type: t3.medium
    vpc_subnet_id: subnet-06ffe524598660d99
    groups:
      - database
    tags:
      Name: molecule_${MOLECULE_IT_PLATFORM}_db_${BRANCH_NAME}_${BUILD_NUMBER}
      Owner: Ops Readiness Team
      Department: Engineering
      Production: false
  - name: activemq
    image: ${MOLECULE_IT_IMAGE_ID}
    instance_type: t3.medium
    vpc_subnet_id: subnet-06ffe524598660d99
    groups:
      - activemq
    tags:
      Name: molecule_${MOLECULE_IT_PLATFORM}_mq_${BRANCH_NAME}_${BUILD_NUMBER}
      Owner: Ops Readiness Team
      Department: Engineering
      Production: false
  - name: search
    image: ${MOLECULE_IT_IMAGE_ID}
    instance_type: t3.medium
    vpc_subnet_id: subnet-06ffe524598660d99
    groups:
      - search
    tags:
      Name: molecule_${MOLECULE_IT_PLATFORM}_se_${BRANCH_NAME}_${BUILD_NUMBER}
      Owner: Ops Readiness Team
      Department: Engineering
      Production: false
  - name: repository
    image: ${MOLECULE_IT_IMAGE_ID}
    instance_type: t3.medium
    vpc_subnet_id: subnet-06ffe524598660d99
    groups:
      - repository
    tags:
      Name: molecule_${MOLECULE_IT_PLATFORM}_r_${BRANCH_NAME}_${BUILD_NUMBER}
      Owner: Ops Readiness Team
      Department: Engineering
      Production: false
  - name: transformers
    image: ${MOLECULE_IT_IMAGE_ID}
    instance_type: t3.medium
    vpc_subnet_id: subnet-06ffe524598660d99
    groups:
      - transformers
    tags:
      Name: molecule_${MOLECULE_IT_PLATFORM}_t_${BRANCH_NAME}_${BUILD_NUMBER}
      Owner: Ops Readiness Team
      Department: Engineering
      Production: false
  - name: syncservice
    image: ${MOLECULE_IT_IMAGE_ID}
    instance_type: t3.medium
    vpc_subnet_id: subnet-06ffe524598660d99
    groups:
      - syncservice
    tags:
      Name: molecule_${MOLECULE_IT_PLATFORM}_sy_${BRANCH_NAME}_${BUILD_NUMBER}
      Owner: Ops Readiness Team
      Department: Engineering
      Production: false
  - name: nginx
    image: ${MOLECULE_IT_IMAGE_ID}
    instance_type: t3.medium
    vpc_subnet_id: subnet-06ffe524598660d99
    groups:
      - nginx
    tags:
      Name: molecule_${MOLECULE_IT_PLATFORM}_n_${BRANCH_NAME}_${BUILD_NUMBER}
      Owner: Ops Readiness Team
      Department: Engineering
      Production: false

provisioner:
  name: ansible
  ansible_args:
    - -e
    - "@${MOLECULE_IT_EXTRA_VARS}"
    - -e
    - "@tests/test-ssl.yml"
  inventory:
    links: 
      group_vars: ../../group_vars
  playbooks:
    converge: ../../playbooks/acs.yml
