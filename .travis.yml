---
os: linux
dist: xenial
language: python
python:
  - "3.9.0"

services:
  - docker

branches:
  only:
    - master
    - contribs
    - /feature.*/
    - /fix.*/
    - /OPSEXP-.*/

before_install:
  - pip install ansible==${ANSIBLE_VERSION}

env:
  global:
    - MOLECULE_NO_LOG=false
    - ANSIBLE_VERSION="2.9.21"

stages:
  - name: Verification

jobs:
  include:
    - stage: Verification
      name: Localhost integration checks (ACS 6.2.2 on CentOS 7)
      install: skip
      script:
        - ./scripts/integration/script.sh ami-0affd4508a5d2481b 6.2.N-extra-vars.yml test-config-acs6-stack.json centos7
    - stage: Verification
      name: Localhost integration checks (ACS 7.1.0 on CentOS 8)
      install: skip
      script:
        - ./scripts/integration/script.sh ami-0d6e9a57f6259ba3a tests/test-extra-vars.yml test-config.json centos8
