---
- name: talk to all hosts just so we can learn about them
  hosts: all
  tasks:
    - name: Classify hosts depending on their OS distribution
      group_by:
        key: "{{ ansible_distribution }}{{ ansible_distribution_major_version }}"
      failed_when: false
      changed_when: false
      ignore_errors: true

- name: Converge
  hosts: all
  tasks:
    - name: "Include tomcat"
      include_role:
        name: "tomcat"

    - name: Ensure tomcat service is started and enabled on boot
      systemd:
        name: tomcat.service
        state: started
      changed_when: false