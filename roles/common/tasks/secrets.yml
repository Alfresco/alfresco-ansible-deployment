---
# tasks file for common secrets
- name: Generate tracking/search shared secret (none provided)
  set_fact:
    reposearch_shared_secret: "{{ lookup('password', '/dev/null') }}"
  delegate_to: localhost
  delegate_facts: true
  run_once: true
  when: hostvars.localhost.reposearch_shared_secret is undefined

- name: Set tracking/search shared secret
  set_fact:
    reposearch_shared_secret: "{{ hostvars.localhost.reposearch_shared_secret }}"
  when: inventory_hostname in groups.repository + groups.search
