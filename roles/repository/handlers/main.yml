---
# handlers file for repository
- name: acs-monitored-restart
  throttle: 1
  block:
    - name: restart-alfresco-content
      become: true
      service:
        name: "alfresco-content"
        state: restarted
        daemon_reload: true
    - name: wait-alfresco-content-ready
      uri:
        url: "http://127.0.0.1:{{ ports_cfg.repository.http }}/alfresco/api/-default-/public/alfresco/versions/1/probes/-ready-"
        timeout: 5
      register: result
      until: result.status == 200
      retries: 15
      delay: 30
