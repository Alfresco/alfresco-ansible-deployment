---
- name: talk to all hosts just so we can learn about them
  hosts: all
  tasks:
    - name: Classify hosts depending on their OS distribution
      group_by:
        key: "{{ ansible_distribution }}{{ ansible_distribution_major_version }}"
      failed_when: false

- name: Converge
  hosts: all
  tasks:
    - name: "Include postgres"
      include_role:
        name: "postgres"
    - name: "Include repository"
      include_role:
        name: "repository"
    - name: "Include activemq"
      include_role:
        name: "activemq"
    - name: "Include sync"
      include_role:
        name: "sync"
